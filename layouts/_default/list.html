{{ define "main" }}
    {{ $paginator := .Paginate .Data.Pages }}
    {{ $title := .Title }}
    <main class="posts">
        <h1>{{ .Title }}</h1>

        {{ if .Content }}
            <div class="content">{{ .Content }}</div>
        {{ end }}

        {{ if eq .Title "Posts" }}
        {{ range site.Pages.GroupByParam "week" "desc"}}
            <div class="posts-group">  
                <div class="post-year">{{ .Key }}</div>    
                <ul class="posts-list">
                    {{ range .Pages }}
                          
                        <li class="post-item">
                            <a href="{{.Permalink}}">
                                <span class="post-title">{{.Title}}</span>
                                <span class="post-day">
                                    {{ if .Site.Params.dateformShort }}
                                        {{ .Date.Format .Site.Params.dateformShort }}
                                    {{ else }}
                                        {{ .Date.Format "Jan 2"}}
                                    {{ end }}
                                </span>
                            </a>
                        </li>
                               
                    {{ end }}
                </ul>
            </div>
        {{ end }}
        {{ end }}
        {{ $weektags := slice  "pre-challenge" "week-1" "week-2" "week-3" "week-4"}}
        {{ $weektitles := slice "Pre-challenge" "Week 1" "Week 2" "Week 3" "Week 4"}}
        {{ range $index, $val := $weektags }}
            {{ if eq $title $val }}
            {{ range site.Pages.GroupByParam "week" "desc"}}
            <div class="posts-group">  
                    {{ if eq .Key (index $weektitles $index) }}
                    <div class="post-year">{{ .Key }}</div> 
                    {{ end }}
                <ul class="posts-list">
                    {{ $t := slice $val }}
                    {{ range where .Pages ".Params.tags" "intersect" $t}}
                        <li class="post-item">
                            <a href="{{.Permalink}}">
                                <span class="post-title">{{.Title}}</span>
                                <span class="post-day">
                                    {{ if .Site.Params.dateformShort }}
                                        {{ .Date.Format .Site.Params.dateformShort }}
                                    {{ else }}
                                        {{ .Date.Format "Jan 2"}}
                                    {{ end }}
                                </span>
                            </a>
                        </li>                                
                 {{ end }}
                </ul>
            </div>
            {{ end }}
        {{ end }}
        {{ end }}
    </main>
{{ end }}
